#include <iostream>
#include <vector>
#include <fstream>
#include <iomanip>
using namespace std;

/* ---------- COURSE CLASS ---------- */
class Course {
public:
    string grade;
    int credits;
    double gradePoint;

    Course(string g, int c, double gp) {
        grade = g;
        credits = c;
        gradePoint = gp;
    }
};
/* ---------- CGPA CALCULATOR CLASS ---------- */
class CGPACalculator {
private:
    vector<Course> courses;
    double totalGradePoints = 0;
    int totalCredits = 0;

    double convertGradeToPoint(string grade) {
        if (grade == "O") return 10;
        if (grade == "A+") return 9;
        if (grade == "A") return 8;
        if (grade == "B+") return 7;
        if (grade == "B") return 6;
        if (grade == "C") return 5;
        return 0; // F or invalid
    }

public:
    void addCourse(string grade, int credits) {
        double gp = convertGradeToPoint(grade);
        courses.push_back(Course(grade, credits, gp));
        totalGradePoints += gp * credits;
        totalCredits += credits;
    }

    double calculateCGPA() {
        return (totalCredits == 0) ? 0 : totalGradePoints / totalCredits;
    }

    void displayResult() {
        cout << fixed << setprecision(2);
        cout << "\nTotal Credits : " << totalCredits << endl;
        cout << "CGPA          : " << calculateCGPA() << endl;
    }

    void saveToFile() {
        ofstream file("CGPA_Report.txt");
        file << fixed << setprecision(2);
        file << "----- CGPA REPORT -----\n";
        file << "Total Credits : " << totalCredits << "\n";
        file << "CGPA          : " << calculateCGPA() << "\n";
        file.close();
        cout << "Result saved to CGPA_Report.txt\n";
    }
};

/* ---------- MAIN FUNCTION ---------- */
int main() {
    CGPACalculator calculator;
    int choice, numCourses, credits;
    string grade;

    do {
        cout << "\n====== CGPA MANAGEMENT SYSTEM ======\n";
        cout << "1. Add Courses & Calculate CGPA\n";
        cout << "2. Exit\n";
        cout << "Enter choice: ";
        cin >> choice;

        switch (choice) {
        case 1:
            cout << "Enter number of courses: ";
            cin >> numCourses;

            for (int i = 1; i <= numCourses; i++) {
                cout << "\nCourse " << i << endl;
                cout << "Enter grade (O, A+, A, B+, B, C, F): ";
                cin >> grade;
                cout << "Enter credits: ";
                cin >> credits;

                if (credits <= 0) {
                    cout << "Invalid credits! Try again.\n";
                    i--;
                    continue;
                }

                calculator.addCourse(grade, credits);
            }

            calculator.displayResult();
            calculator.saveToFile();
            break;

        case 2:
            cout << "Exiting program...\n";
            break;

        default:
            cout << "Invalid choice!\n";
        }

    } while (choice != 2);

    return 0;
}
